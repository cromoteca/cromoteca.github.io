<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cromoteca - Software in Colors</title>
    <meta name="description" content="Cromoteca - Software development content organized by colors. Technical tutorials, documentation, and insights.">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="icon" type="image/png" sizes="192x192" href="favicon-192.png">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="logo-section">
                <a href="index.html" class="logo-link">
                    <img src="header-cromoteca.svg" alt="Cromoteca Logo" class="logo">
                    <div class="brand">
                        <h1 class="site-title">Cromoteca</h1>
                        <p class="tagline">Software in Colors</p>
                    </div>
                </a>
            </div>
            <nav class="nav">
                <a href="#" class="nav-link nav-red" data-language="en">English</a>
                <a href="#" class="nav-link nav-blue" data-language="fr">Fran√ßais</a>
                <a href="#" class="nav-link nav-green" data-language="it">Italiano</a>
            </nav>
        </div>
    </header>

    <main class="main">
        <section class="hero">
            <div class="container">
                <h2 class="hero-title">Welcome to <span class="highlight-green">Software</span> in <span class="highlight-blue">Colors</span></h2>
                <p class="hero-description">My name is Luciano Vernaschi and this site is my point of presence in the virtual world.</p>
            </div>
        </section>

        <section class="blog-section">
            <div class="container">
                <div class="posts-grid">
                    <!-- Posts will be generated here by build-posts.js -->
                </div>
            </div>
        </section>
    </main>

    <footer class="footer">
        <div class="container">
            <p class="footer-text">&copy; 2025 Luciano Vernaschi.</p>
        </div>
    </footer>

    <script>
        // Blog language filtering with localStorage persistence
        document.addEventListener('DOMContentLoaded', function() {
            const navLinks = document.querySelectorAll('.nav-link');
            const posts = document.querySelectorAll('.post-card');
            const STORAGE_KEY = 'cromoteca-preferred-language';

            // Valid languages we support
            const validLangs = ['en', 'fr', 'it'];

            // Determine preferred language (priority: saved > browser > default)
            function getPreferredLanguage() {
                // 1. Check localStorage for saved preference
                const savedLang = localStorage.getItem(STORAGE_KEY);
                if (savedLang && validLangs.includes(savedLang)) {
                    return savedLang;
                }

                // 2. Detect browser language
                const browserLang = navigator.language || navigator.userLanguage;
                const langCode = browserLang.split('-')[0]; // Get 'en' from 'en-US'
                if (validLangs.includes(langCode)) {
                    return langCode;
                }

                // 3. Default to English
                return 'en';
            }

            // Filter posts by detected/saved language on page load
            const preferredLang = getPreferredLanguage();
            filterByLanguage(preferredLang);

            function filterByLanguage(language) {
                // Save preference to localStorage
                localStorage.setItem(STORAGE_KEY, language);

                // Update active state on nav
                navLinks.forEach(l => l.classList.remove('active'));
                const activeLink = document.querySelector(`[data-language="${language}"]`);
                if (activeLink) activeLink.classList.add('active');

                // Show/hide posts - always filter by language (no "show all" option)
                posts.forEach(post => {
                    if (post.getAttribute('data-language') === language) {
                        post.style.display = 'flex';
                        post.style.animation = 'fadeIn 0.3s ease-in';
                    } else {
                        post.style.display = 'none';
                    }
                });
            }

            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const language = this.getAttribute('data-language');
                    filterByLanguage(language);
                });
            });
        });

        // Add CSS animation
        const style = document.createElement('style');
        style.textContent = `
            @keyframes fadeIn {
                from { opacity: 0; transform: translateY(20px); }
                to { opacity: 1; transform: translateY(0); }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
